import { fundingRateFormatter } from "./index";

describe("fundingRateFormatter", () => {
  test.each([
    // en-GB
    [undefined, "en-GB", "---"],
    [null, "en-GB", "---"],
    ["notANumber", "en-GB", "---"],
    [NaN, "en-GB", "---"],
    [42, "en-GB", "42"],
    [41.8, "en-GB", "42"],
    [41.4, "en-GB", "41"],
    [4.18, "en-GB", "4.2"],
    [4.14, "en-GB", "4.1"],
    [4.143, "en-GB", "4.1"],
    [4.1433, "en-GB", "4.1"],
    [0.414, "en-GB", "0.41"],
    [0.0418, "en-GB", "0.042"],
    [0.04181, "en-GB", "0.042"],
    [0.041811, "en-GB", "0.042"],
    [0.0414, "en-GB", "0.041"],
    [0.00418, "en-GB", "0.0042"],
    [0.00414, "en-GB", "0.0041"],
    [0.00000414, "en-GB", "~0.0000"],
    [0.001, "en-GB", "0.001"],
    [0.00003, "en-GB", "~0.0000"],
    [-42, "en-GB", "-42"],
    [-41.8, "en-GB", "-42"],
    [-41.4, "en-GB", "-41"],
    [-4.18, "en-GB", "-4.2"],
    [-4.14, "en-GB", "-4.1"],
    [-4.143, "en-GB", "-4.1"],
    [-4.1433, "en-GB", "-4.1"],
    [-0.414, "en-GB", "-0.41"],
    [-0.0418, "en-GB", "-0.042"],
    [-0.0414, "en-GB", "-0.041"],
    [-0.00418, "en-GB", "-0.0042"],
    [-0.00414, "en-GB", "-0.0041"],
    [-0.00000414, "en-GB", "~0.0000"],
    [-0.000004143, "en-GB", "~0.0000"],
    [-0.00001, "en-GB", "~0.0000"],
    [0.001, "en-GB", "0.001"],
    [0.01, "en-GB", "0.01"],
    [0.1, "en-GB", "0.1"],
    [1, "en-GB", "1"],
    [10, "en-GB", "10"],
    [0.00123, "en-GB", "0.0012"],
    [-0.00123, "en-GB", "-0.0012"],
    [-0.001, "en-GB", "-0.001"],
    [-0.01, "en-GB", "-0.01"],
    [-0.1, "en-GB", "-0.1"],
    [-1, "en-GB", "-1"],
    [-10, "en-GB", "-10"],
    [-0.00123, "en-GB", "-0.0012"],
    // 'ja' (Japanese)
    [42, "ja", "42"],
    [41.8, "ja", "42"],
    [41.4, "ja", "41"],
    [4.18, "ja", "4.2"],
    [4.14, "ja", "4.1"],
    [0.414, "ja", "0.41"],
    [0.0418, "ja", "0.042"],
    [0.0414, "ja", "0.041"],
    [0.00418, "ja", "0.0042"],
    [0.00414, "ja", "0.0041"],
    [0.00000414, "ja", "~0.0000"],
    [-42, "ja", "-42"],
    [-41.8, "ja", "-42"],
    [-41.4, "ja", "-41"],
    [-4.18, "ja", "-4.2"],
    [-4.14, "ja", "-4.1"],
    [-0.414, "ja", "-0.41"],
    [-0.0418, "ja", "-0.042"],
    [-0.0414, "ja", "-0.041"],
    [-0.00418, "ja", "-0.0042"],
    [-0.00414, "ja", "-0.0041"],
    [-0.00000414, "ja", "~0.0000"],
    [-0.000004143, "ja", "~0.0000"],
    [0.001, "ja", "0.001"],
    [0.01, "ja", "0.01"],
    [0.1, "ja", "0.1"],
    [1, "ja", "1"],
    [10, "ja", "10"],
    [0.00123, "ja", "0.0012"],
    [-0.00123, "ja", "-0.0012"],
    [-0.001, "ja", "-0.001"],
    [-0.01, "ja", "-0.01"],
    [-0.1, "ja", "-0.1"],
    [-1, "ja", "-1"],
    [-10, "ja", "-10"],
    [-0.00123, "ja", "-0.0012"],
    // 'ru' (Russian)
    [42, "ru", "42"],
    [41.8, "ru", "42"],
    [41.4, "ru", "41"],
    [4.18, "ru", "4,2"],
    [4.14, "ru", "4,1"],
    [0.414, "ru", "0,41"],
    [0.0418, "ru", "0,042"],
    [0.0414, "ru", "0,041"],
    [0.00418, "ru", "0,0042"],
    [0.00414, "ru", "0,0041"],
    [0.00000414, "ru", "~0,0000"],
    [-42, "ru", "-42"],
    [-41.8, "ru", "-42"],
    [-41.4, "ru", "-41"],
    [-4.18, "ru", "-4,2"],
    [-4.14, "ru", "-4,1"],
    [-0.414, "ru", "-0,41"],
    [-0.0418, "ru", "-0,042"],
    [-0.0414, "ru", "-0,041"],
    [-0.00418, "ru", "-0,0042"],
    [-0.00414, "ru", "-0,0041"],
    [-0.00000414, "ru", "~0,0000"],
    [-0.000004143, "ru", "~0,0000"],
    [0.001, "ru", "0,001"],
    [0.01, "ru", "0,01"],
    [0.1, "ru", "0,1"],
    [1, "ru", "1"],
    [10, "ru", "10"],
    [0.00123, "ru", "0,0012"],
    [-0.00123, "ru", "-0,0012"],
    [-0.001, "ru", "-0,001"],
    [-0.01, "ru", "-0,01"],
    [-0.1, "ru", "-0,1"],
    [-1, "ru", "-1"],
    [-10, "ru", "-10"],
    [-0.00123, "ru", "-0,0012"],
  ])(
    "given value=%p, navigator.language=%p - should return expected output=%p",
    (value, mockedNavigatorLanguage, expected) => {
      // Call the formatter function
      const retValue = fundingRateFormatter(value as number, {
        locale: mockedNavigatorLanguage,
        smallValueLimit: 0.0001,
      });

      // Assert the result
      expect(retValue).toEqual(expected);
    },
  );
});
